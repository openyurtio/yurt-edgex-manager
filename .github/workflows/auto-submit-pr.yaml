on:
   schedule:
     - cron: '0 10 * * *'
name: auto collect info and create pull request
jobs:
  auto-createPR:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: auto collect periodically  
        run: make collect
      - name: Run read-yaml action
        id: yaml-data
        uses: CumulusDS/get-yaml-paths-action@v1.0.1
        with:
          file: ./EdgeXConfig/manifest.yaml
          updated: updated
      - name: Display read-yaml output
        run: |
          echo "${{ steps.yaml-data.outputs.updated }}"
          
      - name: Create Pull Request
        if: ${{steps.yaml-data.outputs.updated == 'true' }}
        uses: peter-evans/create-pull-request@v3
        with:
          commit-message: update config file
          title: The edgeX has been updated
          body: >
            This PR is auto-generated by github action,please check and merge the config file in time.
          labels: update file, automated pr
          branch: auto-generated-branch